# Лабораторная работа №1. Настройка окружения и разведочный анализ данных

## Описание проекта
Данный проект создан в рамках выполнения лабораторной работы №1.  
Основная цель — подготовка структуры проекта, настройка рабочего окружения и проведение разведочного анализа данных (EDA).  
В дальнейшем этот проект будет развиваться при выполнении следующих лабораторных работ.

---

## Структура проекта
На текущем этапе структура проекта имеет вид:
```
lab_1iis
|_____ .venv_my_proj # виртуальное окружение
|_____ .git # локальный репозиторий
|_____ data # папка с исходными и промежуточными данными
| |___ dataset.csv # исходный датасет
| |___ clean_dataset.pkl # очищенный датасет
|
|_____ eda # папка с EDA
| |___ eda.ipynb # блокнот с разведочным анализом данных
|
|_____ graph # графики с EDA
|  |___ graph2.png
|  |___ ...
|
|_____ .gitignore
|_____ README.md
|_____ requirements.txt
```

## Запуск проекта
Чтобы развернуть проект на другой машине, выполните следующие шаги:

1. **Клонировать репозиторий:**
```textmate
git clone https://github.com/Halssara/lab1_iis.git
cd lab_1iis
```

2. **Создать и активировать виртуальное окружение:**
```textmate
python3 -m venv venv
source venv/bin/activate
```

3. **Установить зависимости:**
```textmate
pip install -r requirements.txt
```
4. **Загрузить датасет:**
https://www.kaggle.com/datasets/krishujeniya/heart-diseae
Скопируйте исходный `dataset.csv` в папку `data/`.

6. **Запустить EDA:**  
Открыть блокнот:
```textmate
jupyter notebook eda/eda.ipynb
```
## Результаты EDA

В ходе проведения разведочного анализа данных были выполнены следующие шаги:

1. **Загрузка и знакомство с данными**  
   - Определены числовые и категориальные признаки.  
   - Проверены типы данных 

2. **Очистка данных**  
   - Удалены дубликаты и невалидные значения.  
   - Обработаны пропущенные значения.

3. **Анализ признаков**  
   - Построены графики распределения фичей, матрица корреляции, распределение таргета относительно возраста, интерактивный график целевой переменной в осях холестерина и макимальной частоты биения сердца.  
   - Выявлены зависимости между признаками и целевой переменной.  
   - Определены признаки, которые могут сильно влиять на результат модели.  

4. **Создание новых признаков**  
   - Сформирован дополнительный признак из возраста  

5. **Сохранение данных**  
   - Финальный очищенный датасет сохранён в формате `.pkl` для корректного хранения типов данных.  

### Основные выводы
- Данные успешно загружены и очищены.  
- Были выявлены статистические закономерности, которые помогут при построении модели.  
- Построены графики, подтверждающие зависимость целевой переменной от ключевых признаков.  
- Проект готов к дальнейшей разработке

---


# Лабораторная работа №2. Настройка и исследование моделей машинного обучения

## Цель работы
Основная цель лабораторной работы №2 — провести исследования по настройке и подбору параметров моделей машинного обучения для улучшения качества предсказаний на подготовленном датасете.

## Задачи работы
- Изучить методы предварительной настройки и отбора гиперпараметров моделей.
- Провести настройку различных моделей с использованием выбранных критериев.
- Произвести отбор признаков по важности.
- Провести оценку качества моделей по метрикам.
- Сравнить результаты различных настроек и подобрать лучшую конфигурацию.

## Описание процесса
- На основе подготовленного очищенного датасета построены модели машинного обучения, в том числе с использованием методов sklearn.
- Выполнено логирование модели и её параметров в MLflow.
- Изучены результаты работы модели, проведён отбор признаков с сохранением списка в отдельный JSON-файл.
- Зафиксированы зависимости качества моделей от используемых признаков.

## Результаты ЛР2
- Проведена настройка параметров моделей Random Forest, CatBoost.
- Настроена и зарегистрирована лучшая модель с её сигнатурой и логами.
- Выполнено логирование необходимых артефактов, в том числе файла `best_features.json` с набором выделенных признаков и `requirements.txt`.
- В интерфейсе MLflow отображаются результаты запусков, параметры, метрики и артефакты модели.

---

# Дополнительно

Для запуска mlflow выполнить

```ps1
mlflow server `
    --backend-store-uri sqlite:///mlruns.db `
    --default-artifact-root ./mlartifacts `
    --host localhost `
    --port 5000
```

После запуска откроыть в браузере http://localhost:5000 для просмотра результатов.


## Использование MLflow
В проекте используется MLflow для отслеживания экспериментов и управления версиями моделей. Для запуска сервера MLflow выполните: